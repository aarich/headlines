# Deny access to all .php files in the api directory except those explicitly allowed

<FilesMatch "^(?!history\.php$|status\.php$|update-stat\.php$|headline\.php$).*\.php$">
Order Allow,Deny
Deny from all
</FilesMatch>

# Prevent directory listing

Options -Indexes

# Prevent access to hidden files

<FilesMatch "^\.">
Order Allow,Deny
Deny from all
</FilesMatch>

# Prevent access to config files

<FilesMatch "config\.(local|example)\.php$">
Order Allow,Deny
Deny from all
</FilesMatch>

# Prevent access to db-utils.php

<FilesMatch "db-utils.php">
Order Allow,Deny
Deny from all
</FilesMatch>

# Enable URL rewriting

RewriteEngine On

# Rewrite /api/X to /api/X.php

RewriteRule ^api/([^/]+)$ api/$1.php [L]

# Cache PHP responses for 5 minutes

<IfModule mod_headers.c>
    <FilesMatch "\.php$">
        Header set Cache-Control "max-age=300, public"
    </FilesMatch>
</IfModule>
